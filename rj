#include <reg51.h>
#include <reg51.h>
#include <stdio.h>
#include<intrins.h> 
#define uchar unsigned char
#define uint unsigned int
#define lcd_data P1
/*
	通过外部中断0可以手动控制当前车的状态 开门关门行驶
	通过外部重点1可以手动掉头
	LCD 显示当前状态和到达的站点
	点阵显示当前状态和下一站
*/
sbit rs=P2^0;
sbit rw=P2^1;
sbit en=P2^2;
sbit beeBoom = P2^3;
uchar code dxCode[]={0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,0x7f,0x6f,0x77,0x7c,0x39,0x5e,0x79,0x71}; //七段译码
uchar code pxCode[]={0x40,0x20,0x10,0x08,0x04,0x02,0x01};	//数码管选择
//莆田路
uchar code left_dirc_one_dx[]={
0x02,0x00,0x01,0x10,0x00,0x88,0xff,0xc4,0x00,0x23,0x00,0x40,0x00,0x42,0x00,0x42,0x00,
 0x42,0x40,0x42,0x80,0x42,0x7f,0xc2,0x00,0x43,0x00,0x62,0x00,0x40,0x00,0x00,0x10, 0x02,
0x31,0xfa,0x11,0x02,0x49,0x02,0x89,0xff,0x7f,0x02,0x80,0x00,0x41,0xf8,0x25, 0x08,0x19,0x08,
0x17,0xff,0x21,0x08,0x41,0x08,0xc1,0xfc,0x40,0x08,0x00,0x00,0x00, 0x00,0x03,0xf8,0x01,0x08,
0x01,0x08,0x01,0x08,0x01,0x08,0x01,0x08,0xff,0xff,0x01,0x08,0x01,0x08,0x01,0x08,0x01,0x08,
0x01,0x08,0x03,0xfc,0x00,0x08,0x00,0x00,0x00,0x20,0x00,0x22,0x7f,0xec,0x20,0x00,0x10,0x20,
0x00,0x22,0xff,0xaa,0x0a,0xaa,0x0a, 0xaa,0x0a,0xbf,0x4a,0xaa,0x8a,0xaa,0x7f,0xeb,0x00,0xa2,
0x00,0x20,0x00,0x00,0x20,0x10,0x60,0xd0,0x27,0x12,0x10,0x1c,0x1c,0x10,0x13,0xd0,0x10,0x10,
0xff,0x00,0x41,0x00,0x41,0xff,0x41,0x08,0x41,0x08,0x41,0x08,0xff,0x8c,0x01,0x08,0x00,0x00,0x08,
0x24,0x06,0x24,0x01,0xa4,0xff,0xfe,0x21,0x23,0x1a,0x22,0x02,0xb0,0x3a,0xa8,0x42, 0xa4,0x46,0xa7,
0x5a,0xb4,0x42,0xac,0x62,0xa4,0x0b,0xf0,0x30,0x20,0x00,0x00,0x02, 0x10,0x42,0x10,0x81,0x10,0x7f,
0xff,0x00,0x90,0x80,0x50,0x80,0x80,0x40,0x88,0x30, 0x88,0x0c,0x88,0x03,0xff,0x0c,0x88,0x30,0x8c,
0xc0,0xc8,0x40,0x80,0x00,0x00,0x40, 0x10,0x22,0x10,0x15,0xf0,0x08,0x1f,0x14,0x10,0x63,0xf0,0x00,
0x80,0x00,0x82,0x40, 0x82,0x80,0x82,0x7f,0xe2,0x00,0x92,0x00,0x8a,0x00,0xc6,0x00,0x80,0x00,0x00,
0x00, 0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0xff,0xfe,0x00,0x02,0x00, 0x22,0x00,0x42,
0x00,0x82,0x01,0x82,0x00,0x02,0x00,0x03,0x00,0x02,0x00,0x00,0x00, 0x80,0x00,0x80,0x00,0x80,0x00,0x80,
0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00, 0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0xc0,
0x00,0x80,0x00,0x00,0x20, 0x10,0x60,0xd0,0x27,0x12,0x10,0x1c,0x1c,0x10,0x13,0xd0,0x10,0x10,0xff,0x00,0x41,
0x00,0x41,0xff,0x41,0x08,0x41,0x08,0x41,0x08,0xff,0x8c,0x01,0x08,0x00,0x00,
0x00, 0x40,0x00,0x44,0x00,0x44,0xff,0x44,0x15,0x44,0x15,0x5f,0x15,0x44,0xff,0xf4,0x15,
 0x44,0x55,0x5f,0x95,0x44,0x7f,0xd4,0x01,0x66,0x00,0x44,0x00,0x40,0x00,0x00,0x00, 
0x00,0x00,0x00,0x7f,0xfe,0x20,0x82,0x20,0x82,0x20,0x82,0x20,0x82,0x3f,0xfe,0x20, 
0x82,0x20,0x82,0x20,0x82,0x20,0x82,0x7f,0xff,0x00,0x02,0x00,0x00,0x00,0x00,0x40, 
0x00,0x7e,0xfe,0x40,0x42,0x3f,0xc2,0x22,0x42,0x22,0x7f,0x01,0x12,0xff,0x08,0x42, 
0x8c,0x42,0x57,0x42,0x24,0x42,0x54,0x42,0x8c,0xff,0x84,0x02,0x80,0x00,0x00,
};
//人杰湖公园
uchar code left_dirc_tow_dx[]={
0x02,0x00,0x01,0x10,0x00,0x88,0xff,0xc4,0x00,0x23,0x00,0x40,0x00,0x42,0x00,0x42,0x00,
 0x42,0x40,0x42,0x80,0x42,0x7f,0xc2,0x00,0x43,0x00,0x62,0x00,0x40,0x00,0x00,0x10, 0x02,
0x31,0xfa,0x11,0x02,0x49,0x02,0x89,0xff,0x7f,0x02,0x80,0x00,0x41,0xf8,0x25, 0x08,0x19,0x08,
0x17,0xff,0x21,0x08,0x41,0x08,0xc1,0xfc,0x40,0x08,0x00,0x00,0x00, 0x00,0x03,0xf8,0x01,0x08,
0x01,0x08,0x01,0x08,0x01,0x08,0x01,0x08,0xff,0xff,0x01, 0x08,0x01,0x08,0x01,0x08,0x01,0x08,
0x01,0x08,0x03,0xfc,0x00,0x08,0x00,0x00,0x00, 0x20,0x00,0x22,0x7f,0xec,0x20,0x00,0x10,0x20,
0x00,0x22,0xff,0xaa,0x0a,0xaa,0x0a, 0xaa,0x0a,0xbf,0x4a,0xaa,0x8a,0xaa,0x7f,0xeb,0x00,0xa2,
0x00,0x20,0x00,0x00,0x20, 0x10,0x60,0xd0,0x27,0x12,0x10,0x1c,0x1c,0x10,0x13,0xd0,0x10,0x10,
0xff,0x00,0x41, 0x00,0x41,0xff,0x41,0x08,0x41,0x08,0x41,0x08,0xff,0x8c,0x01,0x08,0x00,0x00,0x08,
0x24,0x06,0x24,0x01,0xa4,0xff,0xfe,0x21,0x23,0x1a,0x22,0x02,0xb0,0x3a,0xa8,0x42, 0xa4,0x46,0xa7,
0x5a,0xb4,0x42,0xac,0x62,0xa4,0x0b,0xf0,0x30,0x20,0x00,0x00,0x02, 0x10,0x42,0x10,0x81,0x10,0x7f,
0xff,0x00,0x90,0x80,0x50,0x80,0x80,0x40,0x88,0x30, 0x88,0x0c,0x88,0x03,0xff,0x0c,0x88,0x30,0x8c,
0xc0,0xc8,0x40,0x80,0x00,0x00,0x40, 0x10,0x22,0x10,0x15,0xf0,0x08,0x1f,0x14,0x10,0x63,0xf0,0x00,0x80,0x00,0x82,0x40, 0x82,0x80,0x82,0x7f,0xe2,0x00,0x92,0x00,0x8a,0x00,0xc6,0x00,0x80,0x00,0x00,0x00, 0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0xff,0xfe,0x00,0x02,0x00, 0x22,0x00,0x42,0x00,0x82,0x01,0x82,0x00,0x02,0x00,0x03,0x00,0x02,0x00,0x00,0x00, 0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00, 0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0xc0,0x00,0x80,0x00,0x00,0x20, 0x10,0x60,0xd0,0x27,0x12,0x10,0x1c,0x1c,0x10,0x13,0xd0,0x10,0x10,0xff,0x00,0x41,
0x00,0x41,0xff,0x41,0x08,0x41,0x08,0x41,0x08,0xff,0x8c,0x01,0x08,0x00,0x00,
0x00, 0x00,0x80,0x00,0x40,0x00,0x20,0x00,0x10,0x00,0x0c,0x00,0x03,0x80,0x00,0x7f,0x03, 
0x80,0x0c,0x00,0x10,0x00,0x20,0x00,0x40,0x00,0xc0,0x00,0x40,0x00,0x00,0x00,0x02, 0x08,
0x82,0x08,0x71,0x08,0x00,0x88,0x00,0x48,0x10,0x28,0x60,0x18,0x07,0xff,0x10, 0x18,0x60,
0x28,0x00,0x48,0x10,0x88,0x21,0x08,0xc3,0x0c,0x01,0x08,0x00,0x00,0x04, 0x10,0xfc,0x21,
0x02,0x62,0x01,0x16,0x7f,0x90,0x20,0x90,0x20,0xff,0x20,0x90,0xbf, 0xd0,0x40,0x90,0x3f,
0xfe,0x42,0x22,0x82,0x22,0x7f,0xff,0x00,0x02,0x00,0x00,0x01, 0x00,0x01,0x00,0x00,0x80,
0x30,0x40,0x28,0x30,0x24,0x0c,0x23,0x00,0x20,0xc0,0x20, 0x06,0x28,0x18,0x30,0x20,0x60,
0x40,0x00,0x80,0x01,0x80,0x00,0x80,0x00,0x00,0x00, 0x00,0xff,0xfe,0x40,0x02,0x50,0x42,
0x48,0x4a,0x47,0xca,0x40,0x4a,0x40,0x4a,0x4f, 0xca,0x50,0x4e,0x50,0x6a,0x5c,0x42,0x40,
0x02,0xff,0xff,0x00,0x02,0x00,0x00,
};
//辽宁大学
uchar code left_dirc_three_dx[]={
0x02,0x00,0x01,0x10,0x00,0x88,0xff,0xc4,0x00,0x23,0x00,0x40,0x00,0x42,0x00,0x42,0x00,
 0x42,0x40,0x42,0x80,0x42,0x7f,0xc2,0x00,0x43,0x00,0x62,0x00,0x40,0x00,0x00,0x10, 0x02,
0x31,0xfa,0x11,0x02,0x49,0x02,0x89,0xff,0x7f,0x02,0x80,0x00,0x41,0xf8,0x25, 0x08,0x19,0x08,
0x17,0xff,0x21,0x08,0x41,0x08,0xc1,0xfc,0x40,0x08,0x00,0x00,0x00, 0x00,0x03,0xf8,0x01,0x08,
0x01,0x08,0x01,0x08,0x01,0x08,0x01,0x08,0xff,0xff,0x01,0x08,0x01,0x08,0x01,0x08,0x01,0x08,
0x01,0x08,0x03,0xfc,0x00,0x08,0x00,0x00,0x00,0x20,0x00,0x22,0x7f,0xec,0x20,0x00,0x10,0x20,
0x00,0x22,0xff,0xaa,0x0a,0xaa,0x0a, 0xaa,0x0a,0xbf,0x4a,0xaa,0x8a,0xaa,0x7f,0xeb,0x00,0xa2,
0x00,0x20,0x00,0x00,0x20, 0x10,0x60,0xd0,0x27,0x12,0x10,0x1c,0x1c,0x10,0x13,0xd0,0x10,0x10,
0xff,0x00,0x41, 0x00,0x41,0xff,0x41,0x08,0x41,0x08,0x41,0x08,0xff,0x8c,0x01,0x08,0x00,0x00,0x08,
0x24,0x06,0x24,0x01,0xa4,0xff,0xfe,0x21,0x23,0x1a,0x22,0x02,0xb0,0x3a,0xa8,0x42, 0xa4,0x46,0xa7,0x5a,0xb4,0x42,0xac,0x62,0xa4,0x0b,0xf0,0x30,0x20,0x00,0x00,0x02, 0x10,0x42,0x10,0x81,0x10,0x7f,0xff,0x00,0x90,0x80,0x50,0x80,0x80,0x40,0x88,0x30, 0x88,0x0c,0x88,0x03,0xff,0x0c,0x88,0x30,0x8c,0xc0,0xc8,0x40,0x80,0x00,0x00,0x40, 0x10,0x22,0x10,0x15,0xf0,0x08,0x1f,0x14,0x10,0x63,0xf0,0x00,0x80,0x00,0x82,0x40, 0x82,0x80,0x82,0x7f,0xe2,0x00,0x92,0x00,0x8a,0x00,0xc6,0x00,0x80,0x00,0x00,0x00, 0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0xff,0xfe,0x00,0x02,0x00, 0x22,0x00,0x42,0x00,0x82,0x01,0x82,0x00,0x02,0x00,0x03,0x00,0x02,0x00,0x00,0x00, 0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00, 0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0xc0,0x00,0x80,0x00,0x00,0x20, 0x10,0x60,0xd0,0x27,0x12,0x10,0x1c,0x1c,0x10,0x13,0xd0,0x10,0x10,0xff,0x00,0x41,
0x00,0x41,0xff,0x41,0x08,0x41,0x08,0x41,0x08,0xff,0x8c,0x01,0x08,0x00,0x00,0x00,0x00,0x40,0x21,0x20,0x22,0x1f,0xe6,0x20,0x00,0x40,0x02,0x40,0x02,0x48,0x02,0x50, 0x02,0x4f,0xf2,0x40,0x12,0x40,0x0a,0x40,0x06,0x60,0x02,0x20,0x00,0x00,0x00,0x00, 0x50,0x00,0x4c,0x00,0x44,0x00,0x44,0x00,0x44,0x40,0x44,0x80,0x45,0x7f,0xc6,0x00, 0x44,0x00,0x44,0x00,0x44,
0x00,0x44,0x00,0x44,0x00,0x54,0x00,0x4c,0x00,0x00,0x00, 0x20,0x40,0x20,0x40,0x20,0x20,0x20,
0x10,0x20,0x0c,0x20,0x03,0xa0,0x00,0x7f,0x01, 0xa0,0x06,0x20,0x08,0x20,0x10,0x20,0x20,0x20,
0x60,0x30,0x20,0x20,0x00,0x00,0x04, 0x40,0x04,0x30,0x04,0x11,0x04,0x96,0x04,0x90,0x44,0x90,
0x84,0x91,0x7e,0x96,0x06, 0x90,0x05,0x90,0x04,0x98,0x04,0x14,0x04,0x13,0x06,0x50,0x04,0x30,0x00,0x00,
};
//沈阳航天航空
uchar code left_dirc_four_dx[]={
0x02,0x00,0x01,0x10,0x00,0x88,0xff,0xc4,0x00,0x23,0x00,0x40,0x00,0x42,0x00,0x42,0x00,
 0x42,0x40,0x42,0x80,0x42,0x7f,0xc2,0x00,0x43,0x00,0x62,0x00,0x40,0x00,0x00,0x10, 0x02,
0x31,0xfa,0x11,0x02,0x49,0x02,0x89,0xff,0x7f,0x02,0x80,0x00,0x41,0xf8,0x25, 0x08,0x19,0x08,
0x17,0xff,0x21,0x08,0x41,0x08,0xc1,0xfc,0x40,0x08,0x00,0x00,0x00, 0x00,0x03,0xf8,0x01,0x08,
0x01,0x08,0x01,0x08,0x01,0x08,0x01,0x08,0xff,0xff,0x01,0x08,0x01,0x08,0x01,0x08,0x01,0x08,
0x01,0x08,0x03,0xfc,0x00,0x08,0x00,0x00,0x00,0x20,0x00,0x22,0x7f,0xec,0x20,0x00,0x10,0x20,
0x00,0x22,0xff,0xaa,0x0a,0xaa,0x0a, 0xaa,0x0a,0xbf,0x4a,0xaa,0x8a,0xaa,0x7f,0xeb,0x00,0xa2,
0x00,0x20,0x00,0x00,0x20, 0x10,0x60,0xd0,0x27,0x12,0x10,0x1c,0x1c,0x10,0x13,0xd0,0x10,0x10,0xff,0x00,0x41, 0x00,0x41,0xff,0x41,0x08,0x41,0x08,0x41,0x08,0xff,0x8c,0x01,0x08,0x00,0x00,0x08,
0x24,0x06,0x24,0x01,0xa4,0xff,0xfe,0x21,0x23,0x1a,0x22,0x02,0xb0,0x3a,0xa8,0x42, 0xa4,0x46,0xa7,0x5a,0xb4,0x42,0xac,0x62,0xa4,0x0b,0xf0,0x30,0x20,0x00,0x00,0x02, 0x10,0x42,0x10,0x81,0x10,0x7f,0xff,0x00,0x90,0x80,0x50,0x80,0x80,0x40,0x88,0x30, 0x88,0x0c,0x88,0x03,0xff,0x0c,0x88,0x30,0x8c,0xc0,0xc8,0x40,0x80,0x00,0x00,0x40, 0x10,0x22,0x10,0x15,0xf0,0x08,0x1f,0x14,0x10,0x63,0xf0,0x00,0x80,0x00,0x82,0x40, 0x82,0x80,0x82,0x7f,0xe2,0x00,0x92,0x00,0x8a,0x00,0xc6,0x00,0x80,0x00,0x00,0x00, 0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0xff,0xfe,0x00,0x02,0x00, 0x22,0x00,0x42,0x00,0x82,0x01,0x82,0x00,0x02,0x00,0x03,0x00,0x02,0x00,0x00,0x00, 0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00, 0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0xc0,0x00,0x80,0x00,0x00,0x20, 0x10,0x60,0xd0,0x27,0x12,0x10,0x1c,0x1c,0x10,0x13,0xd0,0x10,0x10,0xff,0x00,0x41,
0x00,0x41,0xff,0x41,0x08,0x41,0x08,0x41,0x08,0xff,0x8c,0x01,0x08,0x00,0x00,0x04, 0x10,0x04,0x22,0xfe,0x64,0x81,0x0c,0x40,0xa0,0x20,0x18,0x18,0x08,0x07,0x88,0x00, 
0x7f,0x3f,0xc8,0x40,0x08,0x40,0x08,0x40,0x28,0x40,0x18,0x70,0x00,0x00,0x00,0x00, 0x00,0xff,0xfe,0x08,0x02,0x10,0x22,0x08,0xda,0x07,0x06,0x00,0x00,0xff,0xfe,0x40, 0x82,0x40,0x82,0x40,0x82,0x40,0x82,0x40,0x82,0xff,0xff,0x00,0x02,0x00,0x00,0x80, 0x80,0x40,0x80,0x3f,0xfc,0x02,0x96,0x44,0xa5,0x80,0x84,0x7f,0xfc,0x80,0x08,0x40, 0x08,0x3f,0xc9,0x00,0x4a,0x00,0x4e,0x3f,0xe8,0x40,0x4c,0x70,0x08,0x00,0x00,0x80, 0x40,0x80,0x42,0x40,0x42,0x20,0x42,0x10,0x42,0x0c,0x42,0x03,0x42,0x00,0xfe,0x03, 0x42,0x0c,0x42,0x10,0x42,0x20,0x42,0x40,0x43,0xc0,0x62,0x40,0x40,0x00,0x00,0x40, 0x10,0x40,0x0c,0x42,0x84,0x42,0x44,0x42,0x24,0x42,0x34,0x42,0x05,0x7e,0x06,0x42, 0x04,0x42,0x14,0x42,0x24,0x42,0x64,0x42,0xc4,0x60,0x14,0x40,0x0c,0x00,0x00,
};
//师范大学
uchar code left_dirc_five_dx[]={
0x02,0x00,0x01,0x10,0x00,0x88,0xff,0xc4,0x00,0x23,0x00,0x40,0x00,0x42,0x00,0x42,0x00,
 0x42,0x40,0x42,0x80,0x42,0x7f,0xc2,0x00,0x43,0x00,0x62,0x00,0x40,0x00,0x00,0x10, 0x02,
0x31,0xfa,0x11,0x02,0x49,0x02,0x89,0xff,0x7f,0x02,0x80,0x00,0x41,0xf8,0x25, 0x08,0x19,0x08,
0x17,0xff,0x21,0x08,0x41,0x08,0xc1,0xfc,0x40,0x08,0x00,0x00,0x00, 0x00,0x03,0xf8,0x01,0x08,
0x01,0x08,0x01,0x08,0x01,0x08,0x01,0x08,0xff,0xff,0x01,0x08,0x01,0x08,0x01,0x08,0x01,0x08,
0x01,0x08,0x03,0xfc,0x00,0x08,0x00,0x00,0x00,0x20,0x00,0x22,0x7f,0xec,0x20,0x00,0x10,0x20,
0x00,0x22,0xff,0xaa,0x0a,0xaa,0x0a, 0xaa,0x0a,0xbf,0x4a,0xaa,0x8a,0xaa,0x7f,0xeb,0x00,0xa2,
0x00,0x20,0x00,0x00,0x20,0x10,0x60,0xd0,0x27,0x12,0x10,0x1c,0x1c,0x10,0x13,0xd0,0x10,
0x10,0xff,0x00,0x41,0x00,0x41,0xff,0x41,0x08,0x41,0x08,0x41,0x08,0xff,0x8c,0x01,0x08,0x00,0x00,0x08,0x24,0x06,0x24,0x01,0xa4,0xff,0xfe,0x21,0x23,0x1a,0x22,0x02,0xb0,0x3a,0xa8,0x42, 0xa4,0x46,0xa7,0x5a,0xb4,0x42,0xac,0x62,0xa4,0x0b,0xf0,0x30,0x20,0x00,0x00,0x02, 0x10,0x42,0x10,0x81,0x10,0x7f,0xff,0x00,0x90,0x80,0x50,0x80,0x80,0x40,0x88,0x30, 0x88,0x0c,0x88,0x03,0xff,0x0c,0x88,0x30,0x8c,0xc0,0xc8,0x40,0x80,0x00,0x00,0x40, 0x10,0x22,0x10,0x15,0xf0,0x08,0x1f,0x14,0x10,0x63,0xf0,0x00,0x80,0x00,0x82,0x40, 0x82,0x80,0x82,0x7f,0xe2,0x00,0x92,0x00,0x8a,0x00,0xc6,0x00,0x80,0x00,0x00,0x00, 0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0xff,0xfe,0x00,0x02,0x00, 0x22,0x00,0x42,0x00,0x82,0x01,0x82,0x00,0x02,0x00,0x03,0x00,0x02,0x00,0x00,0x00, 0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00, 0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0xc0,0x00,0x80,0x00,0x00,0x20, 0x10,0x60,0xd0,0x27,0x12,0x10,0x1c,0x1c,0x10,0x13,0xd0,0x10,0x10,0xff,0x00,0x41,
0x00,0x41,0xff,0x41,0x08,0x41,0x08,0x41,0x08,0xff,0x8c,0x01,0x08,0x00,0x00,
0x00,0x00,0x8f,0xfc,0x40,0x00,0x30,0x00,0x0f,0xff,0x00,0x00,0x00,0x02,0x3f,0xf2,0x00, 0x12,
0x00,0x12,0xff,0xfe,0x10,0x12,0x20,0x12,0x1f,0xfb,0x00,0x12,0x00,0x00,0x04, 0x04,0x04,0x44,
0xfd,0x94,0x04,0x24,0x02,0x6f,0x00,0x04,0x3f,0xe4,0x40,0x24,0x40,0x24,0x42,0x24,0x44,0x2f,
0x43,0xf4,0x40,0x24,0x40,0x06,0x70,0x04,0x00,0x00,0x00,0x20,0x40,0x20,0x40,0x20,0x20,
0x20,0x10,0x20,0x0c,0x20,0x03,0xa0,0x00,0x7f,0x01,0xa0,0x06,0x20,0x08,0x20,0x10,0x20,
0x20,0x20,0x60,0x30,0x20,0x20,0x00,0x00,0x04,0x40,0x04,0x30,0x04,0x11,0x04,0x96,0x04,
0x90,0x44,0x90,0x84,0x91,0x7e,0x96,0x06,0x90,0x05,0x90,0x04,0x98,0x04,0x14,0x04,0x13,0x06,0x50,0x04,0x30,0x00,0x00,
};
// 医学院
uchar code left_dirc_six_dx[]={
0x02,0x00,0x01,0x10,0x00,0x88,0xff,0xc4,0x00,0x23,0x00,0x40,0x00,0x42,0x00,0x42,0x00,
0x42,0x40,0x42,0x80,0x42,0x7f,0xc2,0x00,0x43,0x00,0x62,0x00,0x40,0x00,0x00,0x10, 0x02,
0x31,0xfa,0x11,0x02,0x49,0x02,0x89,0xff,0x7f,0x02,0x80,0x00,0x41,0xf8,0x25, 0x08,0x19,0x08,
0x17,0xff,0x21,0x08,0x41,0x08,0xc1,0xfc,0x40,0x08,0x00,0x00,0x00, 0x00,0x03,0xf8,0x01,0x08,
0x01,0x08,0x01,0x08,0x01,0x08,0x01,0x08,0xff,0xff,0x01,0x08,0x01,0x08,0x01,0x08,0x01,0x08,
0x01,0x08,0x03,0xfc,0x00,0x08,0x00,0x00,0x00,0x20,0x00,0x22,0x7f,0xec,0x20,0x00,0x10,0x20,
0x00,0x22,0xff,0xaa,0x0a,0xaa,0x0a, 0xaa,0x0a,0xbf,0x4a,0xaa,0x8a,0xaa,0x7f,0xeb,0x00,0xa2,
0x00,0x20,0x00,0x00,0x20,0x10,0x60,0xd0,0x27,0x12,0x10,0x1c,0x1c,0x10,0x13,0xd0,0x10,
0x10,0xff,0x00,0x41,0x00,0x41,0xff,0x41,0x08,0x41,0x08,0x41,0x08,0xff,0x8c,0x01,0x08,0x00,0x00,0x08,0x24,0x06,0x24,0x01,0xa4,0xff,0xfe,0x21,0x23,0x1a,0x22,0x02,0xb0,0x3a,0xa8,0x42, 0xa4,0x46,0xa7,0x5a,0xb4,0x42,0xac,0x62,0xa4,0x0b,0xf0,0x30,0x20,0x00,0x00,0x02, 0x10,0x42,0x10,0x81,0x10,0x7f,0xff,0x00,0x90,0x80,0x50,0x80,0x80,0x40,0x88,0x30, 0x88,0x0c,0x88,0x03,0xff,0x0c,0x88,0x30,0x8c,0xc0,0xc8,0x40,0x80,0x00,0x00,0x40, 0x10,0x22,0x10,0x15,0xf0,0x08,0x1f,0x14,0x10,0x63,0xf0,0x00,0x80,0x00,0x82,0x40, 0x82,0x80,0x82,0x7f,0xe2,0x00,0x92,0x00,0x8a,0x00,0xc6,0x00,0x80,0x00,0x00,0x00, 0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0xff,0xfe,0x00,0x02,0x00, 0x22,0x00,0x42,0x00,0x82,0x01,0x82,0x00,0x02,0x00,0x03,0x00,0x02,0x00,0x00,0x00, 0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00, 0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0xc0,0x00,0x80,0x00,0x00,0x20, 0x10,0x60,0xd0,0x27,0x12,0x10,0x1c,0x1c,0x10,0x13,0xd0,0x10,0x10,0xff,0x00,0x41,
0x00,0x41,0xff,0x41,0x08,0x41,0x08,0x41,0x08,0xff,0x8c,0x01,0x08,0x00,0x00,
0x00,0x00,0x7f,0xfe,0x40,0x02,0x40,0xa2,0x50,0x92,0x50,0x9e,0x48,0x92,0x46,0x92,0x41, 
0xf2,0x42,0x92,0x44,0x92,0x4c,0x9a,0x58,0xd3,0x40,0x82,0x00,0x00,0x00,0x00,0x04, 0x40,
0x04,0x30,0x04,0x11,0x04,0x96,0x04,0x90,0x44,0x90,0x84,0x91,0x7e,0x96,0x06, 0x90,0x05,
0x90,0x04,0x98,0x04,0x14,0x04,0x13,0x06,0x50,0x04,0x30,0x00,0x00,0x00, 0x00,0xff,0xfe,
0x04,0x22,0x08,0x5a,0x87,0x96,0x81,0x0c,0x41,0x24,0x31,0x24,0x0f, 0x25,0x01,0x26,0x3f,
0x24,0x41,0x34,0x41,0xa4,0x41,0x14,0x70,0x0c,0x00,0x00,
};
//三台子
uchar code left_dirc_seven_dx[]={
0x02,0x00,0x01,0x10,0x00,0x88,0xff,0xc4,0x00,0x23,0x00,0x40,0x00,0x42,0x00,0x42,0x00,
0x42,0x40,0x42,0x80,0x42,0x7f,0xc2,0x00,0x43,0x00,0x62,0x00,0x40,0x00,0x00,0x10, 0x02,
0x31,0xfa,0x11,0x02,0x49,0x02,0x89,0xff,0x7f,0x02,0x80,0x00,0x41,0xf8,0x25, 0x08,0x19,0x08,
0x17,0xff,0x21,0x08,0x41,0x08,0xc1,0xfc,0x40,0x08,0x00,0x00,0x00, 0x00,0x03,0xf8,0x01,0x08,
0x01,0x08,0x01,0x08,0x01,0x08,0x01,0x08,0xff,0xff,0x01,0x08,0x01,0x08,0x01,0x08,0x01,0x08,
0x01,0x08,0x03,0xfc,0x00,0x08,0x00,0x00,0x00,0x20,0x00,0x22,0x7f,0xec,0x20,0x00,0x10,0x20,
0x00,0x22,0xff,0xaa,0x0a,0xaa,0x0a, 0xaa,0x0a,0xbf,0x4a,0xaa,0x8a,0xaa,0x7f,0xeb,0x00,0xa2,
0x00,0x20,0x00,0x00,0x20,0x10,0x60,0xd0,0x27,0x12,0x10,0x1c,0x1c,0x10,0x13,0xd0,0x10,
0x10,0xff,0x00,0x41,0x00,0x41,0xff,0x41,0x08,0x41,0x08,0x41,0x08,0xff,0x8c,0x01,0x08,0x00,
0x00,0x08,0x24,0x06,0x24,0x01,0xa4,0xff,0xfe,0x21,0x23,0x1a,0x22,0x02,0xb0,0x3a,0xa8,0x42, 0xa4,0x46,0xa7,0x5a,0xb4,0x42,0xac,0x62,0xa4,0x0b,0xf0,0x30,0x20,0x00,0x00,0x02, 0x10,0x42,0x10,0x81,0x10,0x7f,0xff,0x00,0x90,0x80,0x50,0x80,0x80,0x40,0x88,0x30, 0x88,0x0c,0x88,0x03,0xff,0x0c,0x88,0x30,0x8c,0xc0,0xc8,0x40,0x80,0x00,0x00,0x40, 0x10,0x22,0x10,0x15,0xf0,0x08,0x1f,0x14,0x10,0x63,0xf0,0x00,0x80,0x00,0x82,0x40, 0x82,0x80,0x82,0x7f,0xe2,0x00,0x92,0x00,0x8a,0x00,0xc6,0x00,0x80,0x00,0x00,0x00, 0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0xff,0xfe,0x00,0x02,0x00, 0x22,0x00,0x42,0x00,0x82,0x01,0x82,0x00,0x02,0x00,0x03,0x00,0x02,0x00,0x00,0x00, 0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00, 0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0xc0,0x00,0x80,0x00,0x00,0x20, 0x10,0x60,0xd0,0x27,0x12,0x10,0x1c,0x1c,0x10,0x13,0xd0,0x10,0x10,0xff,0x00,0x41,
0x00,0x41,0xff,0x41,0x08,0x41,0x08,0x41,0x08,0xff,0x8c,0x01,0x08,0x00,0x00,
0x20, 0x00,0x20,0x04,0x20,0x84,0x20,0x84,0x20,0x84,0x20,0x84,0x20,0x84,0x20,0x84,0x20,
0x84,0x20,0x84,0x20,0x84,0x20,0xc4,0x20,0x86,0x30,0x04,0x20,0x00,0x00,0x00,0x00, 0x00,
0x00,0x40,0x00,0x60,0xfe,0x50,0x42,0x48,0x42,0x44,0x42,0x43,0x42,0x40,0x42, 0x40,0x42,
0x40,0x42,0x48,0xff,0x50,0x02,0x60,0x00,0xc0,0x00,0x00,0x00,0x00,0x00, 0x80,0x00,0x80,
0x00,0x82,0x00,0x82,0x00,0x82,0x40,0x82,0x80,0x82,0x7f,0xe2,0x00, 0xa2,0x00,0x92,0x00,
0x8a,0x00,0x86,0x00,0x80,0x00,0xc0,0x00,0x80,0x00,0x00,
};	
//关门请注意
uchar code close_door_dx[]={
0x81,0x00,0x81,0x10,0x41,0x10,0x41,0x11,0x21,0x12,0x11,0x1c,0x0d,0x10,0x03,0xf0,0x0d, 
0x10,0x11,0x18,0x21,0x14,0x21,0x13,0x41,0x1a,0xc1,0x90,0x41,0x00,0x00,0x00,0x00,
0x00,0xff,0xfc,0x00,0x01,0x00,0x02,0x00,0x06,0x00,0x00,0x00,0x02,0x00,0x02,0x00,
0x02,0x00,0x02,0x00,0x02,0x40,0x02,0x80,0x02,0x7f,0xff,0x00,0x02,0x00,0x00,0x00, 
0x20,0x00,0x22,0x7f,0xec,0x20,0x00,0x10,0x20,0x00,0x22,0xff,0xaa,0x0a,0xaa,0x0a,
0xaa,0x0a,0xbf,0x4a,0xaa,0x8a,0xaa,0x7f,0xeb,0x00,0xa2,0x00,0x20,0x00,0x00,0x04,
0x10,0x04,0x22,0xfe,0x64,0x01,0x0c,0x40,0x80,0x41,0x08,0x41,0x08,0x41,0x08,0x41,
0x09,0x7f,0xfe,0x41,0x08,0x41,0x08,0x41,0x88,0x61,0x0c,0x40,0x08,0x00,0x00,0x40,
0x10,0x30,0x10,0x00,0x12,0x77,0xd2,0x85,0x56,0x85,0x5a,0x8d,0x52,0x95,0x53,0xb5, 
0x52,0x85,0x5a,0x85,0x56,0xe7,0xf3,0x00,0x52,0x10,0x18,0x60,0x10,0x00,0x00,
};
//开门请下车
uchar code open_door_dx[]={
0x00,0x80,0x80,0x82,0x40,0x82,0x30,0x82,0x0f,0xfe,0x00,0x82,0x00,0x82,0x00,0x82,0x00, 0x82,0x00,0x82,0xff,0xfe,0x00,0x82,0x00,0x83,0x00,0xc2,0x00,0x80,0x00,0x00,0x00, 0x00,0xff,0xfc,0x00,0x01,0x00,0x02,0x00,0x06,0x00,0x00,0x00,0x02,0x00,0x02,0x00, 0x02,0x00,0x02,0x00,0x02,0x40,0x02,0x80,0x02,0x7f,0xff,0x00,0x02,0x00,0x00,0x00, 0x20,0x00,0x22,0x7f,0xec,0x20,0x00,0x10,0x20,0x00,0x22,0xff,0xaa,0x0a,0xaa,0x0a, 0xaa,0x0a,0xbf,0x4a,0xaa,0x8a,0xaa,0x7f,0xeb,0x00,0xa2,0x00,0x20,0x00,0x00,0x00, 0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0xff,0xfe,0x00,0x02,0x00, 0x22,0x00,0x42,0x00,0x82,0x01,0x82,0x00,0x02,0x00,0x03,0x00,0x02,0x00,0x00,0x04, 0x00,0x04,0x04,0x04,0xc4,0x04,0xa4,0x04,0x94,0x04,0x8c,0x04,0x87,0xff,0xf4,0x04, 0x84,0x04,0x84,0x04,0xc4,0x04,0x84,0x04,0x06,0x06,0x04,0x04,0x00,0x00,0x00,
};
//行驶中请好扶稳
uchar code bus_run_dx[]={
0x02,0x00,0x01,0x10,0x00,0x88,0xff,0xc4,0x00,0x23,0x00,0x40,0x00,0x42,0x00,0x42,0x00,
0x42,0x40,0x42,0x80,0x42,0x7f,0xc2,0x00,0x43,0x00,0x62,0x00,0x40,0x00,0x00,0x10, 0x02,
0x31,0xfa,0x11,0x02,0x49,0x02,0x89,0xff,0x7f,0x02,0x80,0x00,0x41,0xf8,0x25, 0x08,0x19,0x08,
0x17,0xff,0x21,0x08,0x41,0x08,0xc1,0xfc,0x40,0x08,0x00,0x00,0x00, 0x00,0x03,0xf8,0x01,0x08,
0x01,0x08,0x01,0x08,0x01,0x08,0x01,0x08,0xff,0xff,0x01, 0x08,0x01,0x08,0x01,0x08,0x01,0x08,0x01,0x08,0x03,0xfc,0x00,0x08,0x00,0x00,0x00, 0x20,0x00,0x22,0x7f,0xec,0x20,0x00,0x10,0x20,
0x00,0x22,0xff,0xaa,0x0a,0xaa,0x0a, 0xaa,0x0a,0xbf,0x4a,0xaa,0x8a,0xaa,0x7f,0xeb,0x00,0xa2,
0x00,0x20,0x00,0x00,0x20,0x10,0x60,0xd0,0x27,0x12,0x10,0x1c,0x1c,0x10,0x13,0xd0,0x10,
0x10,0xff,0x00,0x41,0x00,0x41,0xff,0x41,0x08,0x41,0x08,0x41,0x08,0xff,0x8c,0x01,0x08,0x00,0x00,0x08,0x24,0x06,0x24,0x01,0xa4,0xff,0xfe,0x21,0x23,0x1a,0x22,0x02,0xb0,0x3a,0xa8,0x42, 0xa4,0x46,0xa7,0x5a,0xb4,0x42,0xac,0x62,0xa4,0x0b,0xf0,0x30,0x20,0x00,0x00,0x02, 0x10,0x42,0x10,0x81,0x10,0x7f,0xff,0x00,0x90,0x80,0x50,0x80,0x80,0x40,0x88,0x30, 0x88,0x0c,0x88,0x03,0xff,0x0c,0x88,0x30,0x8c,0xc0,0xc8,0x40,0x80,0x00,0x00,0x40, 0x10,0x22,0x10,0x15,0xf0,0x08,0x1f,0x14,0x10,0x63,0xf0,0x00,0x80,0x00,0x82,0x40, 0x82,0x80,0x82,0x7f,0xe2,0x00,0x92,0x00,0x8a,0x00,0xc6,0x00,0x80,0x00,0x00,0x00, 0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0x00,0x02,0xff,0xfe,0x00,0x02,0x00, 0x22,0x00,0x42,0x00,0x82,0x01,0x82,0x00,0x02,0x00,0x03,0x00,0x02,0x00,0x00,0x00, 0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00, 0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0x80,0x00,0xc0,0x00,0x80,0x00,0x00,0x20, 0x10,0x60,0xd0,0x27,0x12,0x10,0x1c,0x1c,0x10,0x13,0xd0,0x10,0x10,0xff,0x00,0x41,
0x00,0x41,0xff,0x41,0x08,0x41,0x08,0x41,0x08,0xff,0x8c,0x01,0x08,0x00,0x00,  
};	
xdata unsigned char px _at_ 0x8002;	//片选px
xdata unsigned char dx _at_	0x8004;//段选dx 
xdata unsigned char key _at_	0x8001;
xdata unsigned char clck  _at_ 0x9000;
xdata unsigned char chck  _at_ 0x9001;
xdata unsigned char rlck  _at_ 0x9002;
xdata unsigned char rhck  _at_ 0x9003;
uchar bus_status; //1 行驶 2 开门 3 关门
uchar dirc_status=1; //行驶方向 1代表正向 2 代表 逆向 
int  cur_path_status=0; //当前行驶到哪里 //利用定式器0//
int cur_bus_speed; //当前速度
int dx_cur; //点阵变量
int is_updata_int0 = 0;//1 代表正在用中断修改 
int  updata_clock_and_open_time = 200;//开关门时间// 可修改
int clock_and_open_time = 100;//开关门时间//
int clock_and_open_flag= 1;//1开门 0关门;
int run_strat=900;//初始化车的运行速度//可修改越小车越快
uchar is_run_end = 0; //是否到达了终点
int interput1_pre_status = -1;
uchar code Table_of_C[]=
{
   0xff,0xfe,
   0xff,0xfd,
   0xff,0xfb,
   0xff,0xf7,
   0xff,0xef,
   0xff,0xdf,
   0xff,0xbf,
   0xff,0x7f,
   0xfe,0xff,
   0xfd,0xff,
   0xfb,0xff,
   0xf7,0xff,
   0xef,0xff,
   0xdf,0xff,
   0xbf,0xff,
   0x7f,0xff
};
void delay(int i);
void check_lcd_show(int curIndex);
void lcd_cmd(unsigned char a);
void lcd_show(unsigned char *s);
//外部中断0
void my_int0() interrupt 0{
	bus_status=(bus_status+1)%3;
//开门停车
if(bus_status==2){
		TR0=0;
		lcd_cmd(0x01);
		lcd_cmd(0x80);
		lcd_show("Stop For ");
		lcd_cmd(0xc0);
		lcd_show(" A  While !!!");
		}
		//关门开车
		if(bus_status==1){
		TR0=1;
		lcd_cmd(0x01);
		lcd_cmd(0x80);
		lcd_show("Run Run!");
		lcd_cmd(0xc0);
		lcd_show(" Go Go  Go!!!");
		}
}
//外部中断1
void my_int1() interrupt 2{
  is_run_end = 0;
	dirc_status= dirc_status==1?2:1;
}
//定时器0
void my_time0() interrupt 1{
		TH0 = (65536-50000) % 256;
		bus_status  = 1;
		TL0 = (65536- 50000)/ 256;
		if(--cur_bus_speed>0){
			return;
		}
    if(dirc_status==1){
      interput1_pre_status =-2;
      cur_path_status++;
      if(cur_path_status==7){
      is_run_end = 1;
      }
    }else if(dirc_status == 2){
		if(cur_path_status==7){
		cur_path_status = 5;
		}else{
		cur_path_status--;}
      interput1_pre_status =-2;
      if(cur_path_status==-1){
		is_run_end=1;
      }
    }
		TR0=0;
		TR1=1;
}
//定时器1
void my_time1() interrupt 3{
    int cur = 0;
		TL1  = (65536 - 50000)/256;
		TH1 = (65536 - 50000)%256;
		if(interput1_pre_status!=cur_path_status){
		check_lcd_show(cur_path_status);
		interput1_pre_status = cur_path_status;
	}
		if(clock_and_open_flag==1){
		bus_status = 2;
		}else{
		bus_status = 0;
		}	
	if(--clock_and_open_time>0){
		return ;
		}
		clock_and_open_time= updata_clock_and_open_time;
		clock_and_open_flag^=1;
		if(bus_status == 0){
			TR1=0;
			bus_status =1;
		}
}
void inter_init();
//初始化
void lcd_init();
//选lcd位置
void lcd_cmd(unsigned char a);
//输入数据
void lcd_dat(unsigned char b);
//lcd延迟
void lcd_delay();
//初始化
//显示点阵
void show_dz(int i, uchar *cur_table);
//选择点阵显示
void check_show_dz();
//开车
void bus_run(int speed);
//显示lcd
void  check_left_right_show_dz();
void lcd_init()
{
    lcd_cmd(0x38);
    lcd_cmd(0x0e);
    lcd_cmd(0x01);
    lcd_cmd(0x06);
    lcd_cmd(0x0c);
    lcd_cmd(0x80);
}
//选位置
void lcd_cmd(unsigned char a)
{
    lcd_data=a;
    rs=0;
    rw=0;
    en=1; 
    lcd_delay();
    en=0;
}
//写入数据
void lcd_dat(unsigned char b)
{
    lcd_data=b;
    rs=1;
    rw=0;
    en=1;
    lcd_delay();
    en=0;
}
//显示代码
void lcd_show(unsigned char *s)
{
    while(*s) {
        lcd_dat(*s++);
    }
}
//延迟代码
void lcd_delay()
{
    unsigned int lcd_delay;
    for(lcd_delay=0;lcd_delay<=6000;lcd_delay++);
}
void delay(uint x)
 {  
   uchar i;
   while(x--)
      {
	 for(i=0;i<120;i++);
      }
 }
void inter_init(){
	EX0 = 1;
	IT0 = 1;	
	EX1 = 1;
	IT1 = 1;	
	TMOD = 0x11;
	ET0 = 1;
	ET1=1;
	TL0 = (65536-50000)%256; 
	TH0 = (65536-50000)/256; 
	TL1 = (65536-50000)%256; 
	TH1 = (65536-50000)/256; 
	EA = 1;
}
//公交车开始
void bus_run(uint speed){
	cur_bus_speed = speed;
	TR0=1;
}
//选择lcd亮图
void check_lcd_show(int curIndex){
			if(dirc_status == 1){
				if(curIndex == 1){
				lcd_cmd(0x80);
				lcd_show("Welcome !!!");
				lcd_cmd(0xc0);
				lcd_show("-> P   T    L !!!");
				}
			else if(curIndex ==2){
				lcd_cmd(0x80);
				lcd_show("Welcome !!!!");
				lcd_cmd(0xc0);
				lcd_show("-> R J H G Y!!!");
			}else if(curIndex == 4){
				lcd_cmd(0x80);
				lcd_show("Welcome!!!!");
				lcd_cmd(0xc0);
				lcd_show("-> S  A U !!!");
			}else if(curIndex == 5){
				lcd_cmd(0x80);
				lcd_show("Welcome!!!!");
				lcd_cmd(0xc0);
				lcd_show("-> S  F D X !!!!");
			}else if(curIndex == 6){
				lcd_cmd(0x80);
				lcd_show("Welcome!!!");
				lcd_cmd(0xc0);
				lcd_show("-> Y  X  Y");
			}else if(curIndex == 7 ){
				lcd_cmd(0x80);
				lcd_show("Welcome!!!");
				lcd_cmd(0xc0);
				lcd_show("-> S T Z ");
			}else if(curIndex == 3 ){
				lcd_cmd(0x80);
				lcd_show("Welcome!!!!");
				lcd_cmd(0xc0);
				lcd_show("-> L N D X !!!");
				}	
		}else if(dirc_status==2){
				if(curIndex == -1){
				lcd_cmd(0x80);
				lcd_show("Welcome !!!");
				lcd_cmd(0xc0);
				lcd_show("-> P   T    L !!!");
				}
			else if(curIndex ==0){
				lcd_cmd(0x80);
				lcd_show("Welcome !!!!");
				lcd_cmd(0xc0);
				lcd_show("-> R J H G Y!!!");
			}else if(curIndex == 2){
				lcd_cmd(0x80);
				lcd_show("Welcome!!!!");
				lcd_cmd(0xc0);
				lcd_show("-> S  A U !!!");
			}else if(curIndex == 3){
				lcd_cmd(0x80);
				lcd_show("Welcome!!!!");
				lcd_cmd(0xc0);
				lcd_show("-> S  F D X !!!!");
			}else if(curIndex == 4){
				lcd_cmd(0x80);
				lcd_show("Welcome!!!");
				lcd_cmd(0xc0);
				lcd_show("-> Y  X  Y");
			}else if(curIndex == 5 ){
				lcd_cmd(0x80);
				lcd_show("Welcome!!!");
				lcd_cmd(0xc0);
				lcd_show("-> S T Z ");
			}else if(curIndex == 1){
				lcd_cmd(0x80);
				lcd_show("Welcome!!!!");
				lcd_cmd(0xc0);
				lcd_show("-> L N D X !!!");
				}	
			}
	}
//显示点阵函数
void show_dz(int i ,uchar  *cur_table){
	uint j;
	 for(j=0;j<32;j+=2)
	 {
	    rlck=~Table_of_C[(j)];
	    rhck=~Table_of_C[(j+1)];
	    clck=~cur_table[(i+j)];
	    chck=~cur_table[(i+j+1)];
	    delay(1);
	 }
}
void check_show_dz(int cur_bus_status){
	int size;
//修改延迟程序可以更改点阵的显示速度
  delay(20);
	if(cur_bus_status==1){
			check_left_right_show_dz();
	}else if(cur_bus_status==2){
			size = sizeof(open_door_dx)-32;
			dx_cur = (dx_cur+2)%size;
			show_dz(dx_cur,open_door_dx);
	}else if(cur_bus_status==0){
			size  = sizeof(close_door_dx)-32;
			dx_cur=(dx_cur+2)%size;
			show_dz(dx_cur,close_door_dx);
	}
}
void check_left_right_show_dz(){
	int size;
	if(cur_path_status==0){
			size  = sizeof(left_dirc_one_dx)-32;
			dx_cur=(dx_cur+2)%size;
			show_dz(dx_cur,left_dirc_one_dx);
	}else if(cur_path_status==1){
			size  = sizeof(left_dirc_tow_dx)-32;
			dx_cur=(dx_cur+2)%size;
			show_dz(dx_cur,left_dirc_tow_dx);
	}else if(cur_path_status==2){
			size  = sizeof(left_dirc_three_dx)-32;
			dx_cur=(dx_cur+2)%size;
			show_dz(dx_cur,left_dirc_three_dx);
	}
	else if(cur_path_status==3){
			size  = sizeof(left_dirc_four_dx)-32;
			dx_cur=(dx_cur+2)%size;
			show_dz(dx_cur,left_dirc_four_dx);
	}
	else if(cur_path_status==4){
			size  = sizeof(left_dirc_five_dx)-32;
			dx_cur=(dx_cur+2)%size;
			show_dz(dx_cur,left_dirc_five_dx);
	}
	else if(cur_path_status==5){
			size  = sizeof(left_dirc_six_dx)-32;
			dx_cur=(dx_cur+2)%size;
			show_dz(dx_cur,left_dirc_six_dx);
	}
	else if(cur_path_status==6){
			size  = sizeof(left_dirc_seven_dx)-32;
			dx_cur=(dx_cur+2)%size;
			show_dz(dx_cur,left_dirc_seven_dx);
	}
}
int main(){
	int dxDelaySum,preShowLcd=-2,preRunStatus=-2,nextShowLcd=-2,nextRunStatus=-2,curKeyData=0;
	inter_init();
    lcd_init();
		clock_and_open_time= updata_clock_and_open_time;
    while(1) {
		if(is_run_end == 0){
		if(dirc_status==1){
      nextShowLcd=-2;
      nextRunStatus=-2;
	if(cur_path_status==-1)
{cur_path_status = 1;}
		if(preShowLcd!=cur_path_status&&TR1==0){
			lcd_cmd(0x01);
			lcd_cmd(0x80);
			lcd_show("Run Run!!");
			lcd_cmd(0xc0);
			lcd_show("Go Go  Go !!!");
			preShowLcd= cur_path_status;
			}
		if(preRunStatus!=cur_path_status&&TR1==0){
			bus_run(run_strat);
			preRunStatus=cur_path_status;
			dx_cur= 0;
			}
			check_show_dz(bus_status);
		}else if(dirc_status==2){
    if(cur_path_status==7){
		cur_path_status = 5;
	}
    preShowLcd=-2;
    preRunStatus=-2;
		if(nextShowLcd!=cur_path_status&&TR1==0){	
				lcd_cmd(0x01);
				lcd_cmd(0x80);
				lcd_show("Run Run!!");
				lcd_cmd(0xc0);
				lcd_show("Go Go  Go !!!");
				nextShowLcd= cur_path_status;
			}
	if(nextRunStatus!=cur_path_status&&TR1==0){
			dx_cur= 0;
			bus_run(run_strat);
			nextRunStatus=cur_path_status;
			}
		check_show_dz(bus_status);
      preShowLcd = -2;
      preRunStatus = -2;
      }
    }
  }
}
